/*
 HTML_QuickForm2 client-side validation library
 Package version @package_version@
 http://pear.php.net/package/HTML_QuickForm2

 Copyright 2006-2012, Alexey Borzov, Bertrand Mansion
 Licensed under new BSD license
 http://opensource.org/licenses/bsd-license.php
*/
var qf=qf||{};qf.elements=qf.elements||{};
qf.typeOf=function(a){var b=typeof a;if("function"==b&&"undefined"==typeof a.call)return"object";if("object"==b)if(a){if(a instanceof Array||!(a instanceof Object)&&"[object Array]"==Object.prototype.toString.call(a)&&"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if(!(a instanceof Object)&&("[object Function]"==Object.prototype.toString.call(a)||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&
!a.propertyIsEnumerable("call")))return"function"}else return"null";return b};qf.addNamespace=function(a){for(var a=a.split("."),b=window,c;a.length&&(c=a.shift());)b=b[c]?b[c]:b[c]={}};qf.Map=function(a){this._map={};this._keys=[];this._count=0;a&&this.merge(a)};
qf.Map.prototype=function(){function a(a,b){return Object.prototype.hasOwnProperty.call(a,b)}function b(){if(this._count!=this._keys.length){for(var c=0,b=0,e={};c<this._keys.length;){var f=this._keys[c];a(this._map,f)&&!a(e,f)&&(this._keys[b++]=f,e[f]=!0);c++}this._keys.length=b}}return{hasKey:function(c){return a(this._map,c)},length:function(){return this._count},getValues:function(){b.call(this);for(var a=[],d=0;d<this._keys.length;d++)a.push(this._map[this._keys[d]]);return a},getKeys:function(){b.call(this);
return this._keys.concat()},isEmpty:function(){return 0==this._count},clear:function(){this._map={};this._count=this._keys.length=0},remove:function(c){if(!a(this._map,c))return!1;delete this._map[c];this._count--;this._keys.length>2*this._count&&b.call(this);return!0},get:function(c,b){return a(this._map,c)?this._map[c]:b},set:function(c,b){a(this._map,c)||(this._count++,this._keys.push(c));this._map[c]=b},merge:function(a,b){var e,f,g=0;if(a instanceof qf.Map)e=a.getKeys(),f=a.getValues();else{e=
[];f=[];for(var h in a)e[g]=h,f[g++]=a[h]}h=b||qf.Map.mergeReplace;for(g=0;g<e.length;g++)this.hasKey(e[g])?this.set(e[g],h(this.get(e[g]),f[g])):this.set(e[g],f[g])}}}();qf.Map.mergeReplace=function(a,b){return b};qf.Map.mergeKeep=function(a){return a};qf.Map.mergeArrayConcat=function(a,b){"array"!=qf.typeOf(a)&&(a=[a]);"array"!=qf.typeOf(b)&&(b=[b]);return a.concat(b)};qf.form=function(){return{getValue:function(a){"string"==typeof a&&(a=document.getElementById(a));if(!a||!("type"in a))return null;switch(a.type.toLowerCase()){case "checkbox":case "radio":return a.checked?a.value:null;case "select-one":var b=a.selectedIndex;return-1==b?null:a.options[b].value;case "select-multiple":for(var b=[],c=0;c<a.options.length;c++)a.options[c].selected&&b.push(a.options[c].value);return b;default:return"undefined"==typeof a.value?null:a.value}},getSubmitValue:function(a){"string"==
typeof a&&(a=document.getElementById(a));if(!a||!1 in a||a.disabled)return null;switch(a.type.toLowerCase()){case "reset":case "button":return null;default:return qf.form.getValue(a)}},getContainerSubmitValue:function(){for(var a,b,c=new qf.Map,d=0;d<arguments.length;d++)if(arguments[d]instanceof qf.Map)c.merge(arguments[d],qf.Map.mergeArrayConcat);else if("object"==qf.typeOf(arguments[d])?(a=arguments[d].name,b=arguments[d].value):(a=document.getElementById(arguments[d]).name,b=qf.form.getSubmitValue(arguments[d])),
null!==b){var e={};e[a]=b;c.merge(e,qf.Map.mergeArrayConcat)}return c},setValue:function(a,b){"string"==typeof a&&(a=document.getElementById(a));if(a&&"type"in a)switch(a.type.toLowerCase()){case "checkbox":case "radio":a.checked=!!b;break;case "select-one":var c=a;c.selectedIndex=-1;for(var d,e=0;d=c.options[e];e++)if(d.value==b){d.selected=!0;break}break;case "select-multiple":c=a;d=b;"array"!=qf.typeOf(d)&&(d=[d]);for(var f=0;e=c.options[f];f++){e.selected=!1;for(var g=0,h=d.length;g<h;g++)e.value==
d[g]&&(e.selected=!0)}break;default:a.value=b}}}}();qf.$v=qf.form.getSubmitValue;qf.$cv=qf.form.getContainerSubmitValue;qf.classes={add:function(a,b){"string"==qf.typeOf(b)&&(b=b.split(/\\s+/));if(a.className){for(var c=" "+a.className+" ",d=a.className,e=0,f=b.length;e<f;e++)b[e]&&0>c.indexOf(" "+b[e]+" ")&&(d+=" "+b[e]);a.className=d}else a.className=b.join(" ")},remove:function(a,b){if(a.className){"string"==qf.typeOf(b)&&(b=b.split(/\\s+/));for(var c=(" "+a.className+" ").replace(/[\n\t\r]/g," "),d=0,e=b.length;d<e;d++)b[d]&&(c=c.replace(" "+b[d]+" "," "));a.className=c.replace(/^\s+/,"").replace(/\s+$/,"")}},
has:function(a,b){return-1<(" "+a.className+" ").replace(/[\n\t\r]/g," ").indexOf(" "+b+" ")}};qf.events={test:function(){var a={submitBubbles:!0,changeBubbles:!0,focusinBubbles:!1},b=document.createElement("div");if(b.attachEvent)for(var c in{submit:!0,change:!0,focusin:!0}){var d="on"+c,e=d in b;e||(b.setAttribute(d,"return;"),e="function"===typeof b[d]);a[c+"Bubbles"]=e}return a}(),addListener:function(a,b,c,d){a.addEventListener?a.addEventListener(b,c,d):a.attachEvent("on"+b,c)},removeListener:function(a,b,c,d){a.removeEventListener?a.removeEventListener(b,c,d):a.detachEvent("on"+b,c)},
fixEvent:function(a){a=a||window.event;a.preventDefault=a.preventDefault||function(){this.returnValue=!1};a.stopPropagation=a.stopPropagation||function(){this.cancelBubble=!0};a.target||(a.target=a.srcElement);!a.relatedTarget&&a.fromElement&&(a.relatedTarget=a.fromElement==a.target?a.toElement:a.fromElement);if(null==a.pageX&&null!=a.clientX){var b=document.documentElement,c=document.body;a.pageX=a.clientX+(b&&b.scrollLeft||c&&c.scrollLeft||0)-(b.clientLeft||0);a.pageY=a.clientY+(b&&b.scrollTop||
c&&c.scrollTop||0)-(b.clientTop||0)}!a.which&&a.button&&(a.which=a.button&1?1:a.button&2?3:a.button&4?2:0);return a}};qf.Rule=function(a,b,c,d){this.callback=a;this.owner=b;this.message=c;this.chained=d||[[]]};qf.LiveRule=function(a,b,c,d,e){qf.Rule.call(this,a,b,c,e);this.triggers=d};qf.LiveRule.prototype=new qf.Rule;qf.LiveRule.prototype.constructor=qf.LiveRule;
qf.Validator=function(a,b){this.rules=b||[];this.errors=new qf.Map;a.validator=this;qf.events.addListener(a,"submit",qf.Validator.submitHandler);for(var c=0,d;d=this.rules[c];c++)if(d instanceof qf.LiveRule){qf.events.test.changeBubbles?qf.events.addListener(a,"change",qf.Validator.liveHandler,!0):(qf.events.addListener(a,"click",function(a){var a=qf.events.fixEvent(a),c=a.target;("select"==c.nodeName.toLowerCase()||"input"==c.nodeName.toLowerCase()&&("checkbox"==c.type||"radio"==c.type))&&qf.Validator.liveHandler(a)}),
qf.events.addListener(a,"keydown",function(a){var a=qf.events.fixEvent(a),c=a.target,b="type"in c?c.type:"";(13==a.keyCode&&"textarea"!=c.nodeName.toLowerCase()||32==a.keyCode&&("checkbox"==b||"radio"==b)||"select-multiple"==b)&&qf.Validator.liveHandler(a)}));qf.events.test.focusinBubbles?qf.events.addListener(a,"focusout",qf.Validator.liveHandler,!0):qf.events.addListener(a,"blur",qf.Validator.liveHandler,!0);break}};
qf.Validator.submitHandler=function(a){var a=qf.events.fixEvent(a),b=a.target;b.validator&&!b.validator.run(b)&&a.preventDefault()};qf.Validator.liveHandler=function(a){var a=qf.events.fixEvent(a),b=a.target.form;b.validator&&b.validator.runLive(a)};
qf.Validator.prototype=function(){function a(a){for(a=document.getElementById(a);!qf.classes.has(a,"element")&&"fieldset"!=a.nodeName.toLowerCase();)a=a.parentNode;return a}function b(c,d){c.remove(d.owner);var e=a(d.owner);qf.classes.remove(e,["error","valid"]);for(var e=e.getElementsByTagName("span"),f=e.length-1;0<=f;f--)qf.classes.has(e[f],"error")&&e[f].parentNode.removeChild(e[f]);for(e=0;f=d.chained[e];e++)for(var g=0,h;h=f[g];g++)b(c,h)}return{onStart:function(){for(var a=0,d;d=this.rules[a];a++)b(this.errors,
d)},onFieldError:function(b,d){var e=a(b);qf.classes.add(e,"error");var f=document.createElement("span");f.className="error";f.appendChild(document.createTextNode(d));f.appendChild(document.createElement("br"));if("fieldset"!=e.nodeName.toLowerCase())e.insertBefore(f,e.firstChild);else{var g=e.getElementsByTagName("legend");0==g.length?e.insertBefore(f,e.firstChild):g[g.length-1].parentNode.insertBefore(f,g[g.length-1].nextSibling)}},onFieldValid:function(b){qf.classes.add(a(b),"valid")},onFormValid:function(){},
onFormError:function(){},run:function(a){this.onStart(a);this.errors.clear();for(var a=0,b;b=this.rules[a];a++)this.errors.hasKey(b.owner)||this.validate(b);if(this.errors.isEmpty())return this.onFormValid(),!0;this.onFormError();return!1},runLive:function(a){for(var a=" "+a.target.id+" ",d=new qf.Map,e=-1;d.length()>e;)for(var e=d.length(),f=0,g;g=this.rules[f];f++)if(g instanceof qf.LiveRule&&!d.hasKey(f))for(var h=0,i;i=g.triggers[h];h++)if(-1<a.indexOf(" "+i+" ")){d.set(f,!0);b(this.errors,g);
a+=g.triggers.join(" ")+" ";break}for(f=0;g=this.rules[f];f++)d.hasKey(f)&&!this.errors.hasKey(g.owner)&&this.validate(g)},validate:function(a){for(var b=!1,e=a.callback.call(this),f=0,g;g=a.chained[f];f++){for(var h=0,i;(i=g[h])&&!(e=e&&this.validate(i),!e);h++);if(b=b||e)break;e=!0}if(!b&&a.message&&!this.errors.hasKey(a.owner))this.errors.set(a.owner,a.message),this.onFieldError(a.owner,a.message);else if(!this.errors.hasKey(a.owner))this.onFieldValid(a.owner);return b}}}();qf.rules=qf.rules||{};qf.rules.each=function(a){for(var b=0;b<a.length;b++)if(!a[b]())return!1;return!0};qf.rules.empty=function(a){switch(qf.typeOf(a)){case "array":for(var b=0;b<a.length;b++)if(!qf.rules.empty(a[b]))return!1;return!0;case "undefined":case "null":return!0;default:return""==a}};
qf.rules.nonempty=function(a,b){var c,d=0;if("array"==qf.typeOf(a)){for(c=0;c<a.length;c++)qf.rules.nonempty(a[c],1)&&d++;return d>=b}if(a instanceof qf.Map){var e=a.getValues();if(1==a.length()){c=a.getKeys()[0];var f=e[0];if("[]"==c.slice(-2)&&"array"==qf.typeOf(f))return qf.rules.nonempty(f,b)}for(c=0;c<e.length;c++)qf.rules.nonempty(e[c],1)&&d++;return d>=b}return""!=a&&"undefined"!=qf.typeOf(a)&&"null"!=qf.typeOf(a)};
